
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Model Description &#8212; smartpy latest documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://thibhlln.github.io/smartpy/model_description.html" />
    <link rel="shortcut icon" href="_static/smartpy-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Citation" href="citation.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

    <div id="navbar-start">
      <ul class="navbar-nav">
          <li class="nav-item">
            <a class="navbar-brand" href="index.html">
              <img src="_static/smartpy-logo.svg" class="logo" alt="logo">
            </a>
          </li>
      </ul>
    </div>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    
    <div id="navbar-menu" class=" collapse navbar-collapse">
      <ul class="navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              latest
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown" id="version-menu">
              
                <a class="dropdown-item" href="https://thibhlln.github.io/smartpy">latest</a>
              
            </div>
          </li>
      </ul>

      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="tutorial.html">
  Tutorial
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Model Description
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="citation.html">
  Citation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="support.html">
  Support
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="changelog.html">
  Change Log
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="licence.html">
  Licence
 </a>
</li>

        
      </ul>

      <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/thibhlln/smartpy" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#history">
   History
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conceptual-model">
   Conceptual model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-inputs-and-outputs">
     Model inputs and outputs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-parameters">
     Model parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-equations">
     Model equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#under-energy-limited-conditions">
       Under energy-limited conditions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#under-water-limited-conditions">
       Under water-limited conditions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#under-water-limited-and-energy-limited-conditions">
       Under water-limited and energy-limited conditions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#procedural-model">
   Procedural model
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="model-description">
<h1>Model Description<a class="headerlink" href="#model-description" title="Permalink to this headline"><span class="fa fa-link"></a></h1>
<div class="section" id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this headline"><span class="fa fa-link"></a></h2>
<p>The Soil Moisture Accounting and Routing for Transport [SMART] model
(<a class="reference external" href="https://doi.org/10.1016/j.cageo.2015.08.015">Mockler et al., 2016</a>) is a bucket-type rainfall-runoff model.</p>
<p>SMART is an enhancement of the Soil Moisture Accounting and Routing with
Groundwater [SMARG] model, a lumped rainfall–runoff model developed at
National University of Ireland, Galway (<a class="reference external" href="https://doi.org/10.1016/0022-1694(92)90150-T">Kachroo, 1992</a>), and based on
the soil layers concept (<a class="reference external" href="https://doi.org/10.1016/0022-1694(70)90221-0">O’Connell et al., 1970</a>; <a class="reference external" href="https://doi.org/10.1016/0022-1694(70)90255-6">Nash and Sutcliffe, 1970</a>).
Separate soil layers were introduced to capture the decline with soil depth
in the ability of plant roots to extract water for evapotranspiration.
SMARG was originally developed for flow modelling and forecasting and
was incorporated into the Galway Real-Time River Flow Forecasting System
[GFFS] (<a class="reference external" href="https://doi.org/10.5194/hess-9-394-2005">Goswami et al., 2005</a>).</p>
<p>The SMART model reorganised and extended SMARG to provide a basis for
water quality modelling by separating explicitly the important flow
pathways in a catchment.</p>
</div>
<div class="section" id="conceptual-model">
<h2>Conceptual model<a class="headerlink" href="#conceptual-model" title="Permalink to this headline"><span class="fa fa-link"></a></h2>
<div class="figure align-center" id="id3">
<span id="fig-structure"></span><img alt="SMART model structure" src="_images/smart-model-structure.svg" /><p class="caption"><span class="caption-text">Fig. 1: Conceptual representation of the bucket-type rainfall-runoff model SMART.</span><a class="headerlink" href="#id3" title="Permalink to this image"><span class="fa fa-link"></a></p>
</div>
<div class="section" id="model-inputs-and-outputs">
<h3>Model inputs and outputs<a class="headerlink" href="#model-inputs-and-outputs" title="Permalink to this headline"><span class="fa fa-link"></a></h3>
<span id="tab-inputs"></span><table class="table" id="id4">
<caption><span class="caption-text">Tab. 1: SMART model inputs</span><a class="headerlink" href="#id4" title="Permalink to this table"><span class="fa fa-link"></a></caption>
<colgroup>
<col style="width: 21%" />
<col style="width: 51%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
<td><p>Precipitation as rainfall</p></td>
<td><p>mm per time step</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_P\)</span></p></td>
<td><p>Potential evapotranspiration</p></td>
<td><p>mm per time step</p></td>
</tr>
</tbody>
</table>
<span id="tab-outputs"></span><table class="table" id="id5">
<caption><span class="caption-text">Tab. 2: SMART model outputs</span><a class="headerlink" href="#id5" title="Permalink to this table"><span class="fa fa-link"></a></caption>
<colgroup>
<col style="width: 21%" />
<col style="width: 51%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Output</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(Q\)</span></p></td>
<td><p>River discharge</p></td>
<td><p>kg m<sup>-3</sup></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_A\)</span></p></td>
<td><p>Actual evapotranspiration</p></td>
<td><p>mm per time step</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="model-parameters">
<h3>Model parameters<a class="headerlink" href="#model-parameters" title="Permalink to this headline"><span class="fa fa-link"></a></h3>
<span id="tab-parameters"></span><table class="table" id="id6">
<caption><span class="caption-text">Tab. 3: SMART model parameters</span><a class="headerlink" href="#id6" title="Permalink to this table"><span class="fa fa-link"></a></caption>
<colgroup>
<col style="width: 24%" />
<col style="width: 46%" />
<col style="width: 12%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Typical range*</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_T\)</span></p></td>
<td><p>Rainfall aerial correction factor</p></td>
<td><p>–</p></td>
<td><p>0.9–1.1</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta_C\)</span></p></td>
<td><p>Evaporation decay coefficient</p></td>
<td><p>–</p></td>
<td><p>0–1</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_H\)</span></p></td>
<td><p>Quick runoff ratio</p></td>
<td><p>–</p></td>
<td><p>0–0.3</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta_D\)</span></p></td>
<td><p>Drain flow ratio</p></td>
<td><p>–</p></td>
<td><p>0–1</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_S\)</span></p></td>
<td><p>Soil outflow coefficient</p></td>
<td><p>–</p></td>
<td><p>0–0.013</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta_Z\)</span></p></td>
<td><p>Effective soil depth</p></td>
<td><p>mm</p></td>
<td><p>15–150</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_{SK}\)</span></p></td>
<td><p>Surface reservoir residence time</p></td>
<td><p>timestep</p></td>
<td><p>1–240h</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta_{FK}\)</span></p></td>
<td><p>Interflow reservoir residence time</p></td>
<td><p>timestep</p></td>
<td><p>48–1440h</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_{GK}\)</span></p></td>
<td><p>Groundwater reservoir residence time</p></td>
<td><p>timestep</p></td>
<td><p>1200–4800h</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta_{RK}\)</span></p></td>
<td><p>Channel reservoir residence time</p></td>
<td><p>timestep</p></td>
<td><p>1–96h</p></td>
</tr>
</tbody>
</table>
<dl class="footnote brackets">
<dt class="label" id="id1"><span class="brackets">*</span></dt>
<dd><p>After <a class="reference external" href="https://doi.org/10.1016/j.cageo.2015.08.015">Mockler et al. (2016)</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="model-equations">
<h3>Model equations<a class="headerlink" href="#model-equations" title="Permalink to this headline"><span class="fa fa-link"></a></h3>
<p>The SMART model forcings are precipitation <span class="math notranslate nohighlight">\(P\)</span> [mm/time step] and
potential evapotranspiration <span class="math notranslate nohighlight">\(E_P\)</span> [mm/time step]. The precipitation
input is first transformed into the corrected precipitation <span class="math notranslate nohighlight">\(p_C\)</span>
[mm/time step] using the aerial correction parameter <span class="math notranslate nohighlight">\(\theta_{T}\)</span> [–]
<a class="reference internal" href="#equation-pc">(1)</a>.</p>
<div class="math notranslate nohighlight" id="equation-pc">
<span class="eqno">(1)<a class="headerlink" href="#equation-pc" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[p_C = \theta_{T} P\]</div>
<p>The difference between corrected precipitation and potential evapotranspiration
determines whether the modelling time step is under energy-limited conditions
(condition <span class="math notranslate nohighlight">\(\gamma\)</span> is true) or water-limited conditions (<span class="math notranslate nohighlight">\(\gamma\)</span>
is false) <a class="reference internal" href="#equation-condition">(2)</a>. Then, the effective precipitation <span class="math notranslate nohighlight">\(p_E\)</span>
[mm/time step] <a class="reference internal" href="#equation-pe">(3)</a> and the precipitation contribution to the actual
evapotranspiration <span class="math notranslate nohighlight">\(e_A\)</span> [mm/time step] <a class="reference internal" href="#equation-ea">(4)</a> are determined
accordingly.</p>
<div class="math notranslate nohighlight" id="equation-condition">
<span class="eqno">(2)<a class="headerlink" href="#equation-condition" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\gamma: p_C \geq E_P\]</div>
<div class="math notranslate nohighlight" id="equation-pe">
<span class="eqno">(3)<a class="headerlink" href="#equation-pe" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}p_E =
\begin{cases}
    \theta_{T}P - E_P, &amp; \text{if } \gamma \\
    0,                 &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-ea">
<span class="eqno">(4)<a class="headerlink" href="#equation-ea" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}e_A =
\begin{cases}
    E_P,   &amp; \text{if } \gamma \\
    \theta_{T}P, &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>The two parameters for quick runoff ratio <span class="math notranslate nohighlight">\(\theta_H\)</span> [–] and soil
outflow coefficient <span class="math notranslate nohighlight">\(\theta_S\)</span> [–] are adjusted according to the
antecedent soil moisture conditions to become <span class="math notranslate nohighlight">\(\theta_{H'}\)</span> [–]
<a class="reference internal" href="#equation-hprime">(5)</a> and <span class="math notranslate nohighlight">\(\theta_{S'}\)</span> [–] <a class="reference internal" href="#equation-sprime">(6)</a>, respectively.
The six soil moisture layers are of equal depths and sum up to a total
field capacity defined by the parameter <span class="math notranslate nohighlight">\(\theta_Z\)</span> [mm].</p>
<div class="math notranslate nohighlight" id="equation-hprime">
<span class="eqno">(5)<a class="headerlink" href="#equation-hprime" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\theta_{H'} = \theta_H \frac{\sum_{\lambda=1}^{6} S_{\lambda}}{\theta_Z}\]</div>
<div class="math notranslate nohighlight" id="equation-sprime">
<span class="eqno">(6)<a class="headerlink" href="#equation-sprime" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\theta_{S'} = \theta_S \frac{\sum_{\lambda=1}^{6} S_{\lambda}}{\theta_Z}\]</div>
<div class="section" id="under-energy-limited-conditions">
<h4>Under energy-limited conditions<a class="headerlink" href="#under-energy-limited-conditions" title="Permalink to this headline"><span class="fa fa-link"></a></h4>
<p>The infiltration flux <span class="math notranslate nohighlight">\(q_0\)</span> [mm/time step] and the percolation fluxes
through the soil layers <span class="math notranslate nohighlight">\(q_{\lambda}\)</span> [mm/time step] are then calculated
as described in Equations <a class="reference internal" href="#equation-q0">(7)</a> and <a class="reference internal" href="#equation-qlambda">(8)</a>, respectively.</p>
<div class="math notranslate nohighlight" id="equation-q0">
<span class="eqno">(7)<a class="headerlink" href="#equation-q0" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[q_0 = (1 - \theta_{H'}) p_E\]</div>
<div class="math notranslate nohighlight" id="equation-qlambda">
<span class="eqno">(8)<a class="headerlink" href="#equation-qlambda" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}q_{\lambda} =
\begin{cases}
   q_{\lambda - 1} - \Big(\frac{\theta_{Z}}{6} - S_{\lambda}\Big),
      &amp; \text{if } q_{\lambda - 1} + S_{\lambda} &gt; \frac{\theta_{Z}}{6} \\
   0, &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>If all soil layers reach saturation, the saturation excess flux <span class="math notranslate nohighlight">\(q_6\)</span>
[mm/time step] is divided into quick runoff as drainflow <span class="math notranslate nohighlight">\(r_{DF}\)</span>
[mm/time step] <a class="reference internal" href="#equation-rdf">(9)</a> and slow runoff as interflow. The outflow from
the six soil layers contributes to the three runoff pathways: interflow
<span class="math notranslate nohighlight">\(r_{IF}\)</span> [mm/time step], shallow groundwater flow <span class="math notranslate nohighlight">\(r_{SGW}\)</span>
[mm/time step], and deep groundwater flow <span class="math notranslate nohighlight">\(r_{DGW}\)</span> [mm/time step].
First, the soil outflow contributes to the interflow runoff following a
power law from the top layer to the bottom layer <a class="reference internal" href="#equation-rif">(11)</a>. Then, the
soil outflow contributes to the shallow groundwater runoff following
an inverse law from the top layer to the bottom layer <a class="reference internal" href="#equation-rsgw">(13)</a>.
Finally, the soil outflow contributes to the deep groundwater runoff
following a power law from the bottom layer to the top layer <a class="reference internal" href="#equation-rdgw">(15)</a>.
The parameter <span class="math notranslate nohighlight">\(\theta_{S'}\)</span> is used in each of the three law
distributions to determine the fraction of each soil layer that
contributes to runoff during the modelling time step.</p>
<div class="math notranslate nohighlight" id="equation-rdf">
<span class="eqno">(9)<a class="headerlink" href="#equation-rdf" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[r_{DF} = \theta_D q_6\]</div>
<div class="math notranslate nohighlight" id="equation-sif">
<span class="eqno">(10)<a class="headerlink" href="#equation-sif" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}{s_{IF}}_{\lambda} =
\begin{cases}
   S_{\lambda}(\theta_{S'})^{\lambda}, &amp; \text{if } \gamma \\
   0,                                  &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-rif">
<span class="eqno">(11)<a class="headerlink" href="#equation-rif" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}r_{IF} =
\begin{cases}
   \sum_{\lambda=1}^{6} {s_{IF}}_{\lambda}, &amp; \text{if } \gamma \\
   0,                                       &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-ssgw">
<span class="eqno">(12)<a class="headerlink" href="#equation-ssgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}{s_{SGW}}_{\lambda} =
\begin{cases}
   S_{\lambda}\Big(\frac{\theta_{S'}}{\lambda}\Big), &amp; \text{if } \gamma \\
   0,                                                &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-rsgw">
<span class="eqno">(13)<a class="headerlink" href="#equation-rsgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}r_{SGW} =
\begin{cases}
   \sum_{\lambda=1}^{6} {s_{SGW}}_{\lambda}, &amp; \text{if } \gamma \\
   0,                                        &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-sdgw">
<span class="eqno">(14)<a class="headerlink" href="#equation-sdgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}{s_{DGW}}_{\lambda} =
\begin{cases}
   S_{\lambda}(\theta_{S'})^{7 - \lambda}, &amp; \text{if } \gamma \\
   0,                                      &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-rdgw">
<span class="eqno">(15)<a class="headerlink" href="#equation-rdgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}r_{DGW} =
\begin{cases}
   \sum_{\lambda=1}^{6} {s_{DGW}}_{\lambda}, &amp; \text{if } \gamma \\
   0,                                        &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
</div>
<div class="section" id="under-water-limited-conditions">
<h4>Under water-limited conditions<a class="headerlink" href="#under-water-limited-conditions" title="Permalink to this headline"><span class="fa fa-link"></a></h4>
<p>The water deficit <span class="math notranslate nohighlight">\(d_0\)</span> [mm/time step] <a class="reference internal" href="#equation-d0">(16)</a> to meet the potential
evapotranspiration demand is totally or partially provided by the available
soil moisture evapotranspiration fluxes <span class="math notranslate nohighlight">\(e_{\lambda}\)</span> [mm/time step]
<a class="reference internal" href="#equation-elambda">(18)</a>. The variable <span class="math notranslate nohighlight">\(b_{\lambda}\)</span> [–] <a class="reference internal" href="#equation-blambda">(20)</a> acts
as a boolean to stop the soil moisture contribution to evapotranspiration
as soon as the remaining water deficit <span class="math notranslate nohighlight">\(d_{\lambda}\)</span> [mm/time step]
<a class="reference internal" href="#equation-dlambda">(19)</a> has been fully met by a given soil layer; it is initiated
with a value of 1 if a deficit exists <a class="reference internal" href="#equation-b0">(17)</a>. The first soil layer can
fully meet the water deficit if it contains enough water, otherwise the
second layer can contribute to meeting the remaining water deficit with a
depleted rate using the evaporation decay parameter <span class="math notranslate nohighlight">\(\theta_C\)</span> [–]
<a class="reference internal" href="#equation-dlambda">(19)</a>, and so forth for the next downward layer down to the bottom
layer. Effectively, a lesser fraction of the available soil moisture in a
layer can meet the remaining water deficit moving downwards following a
power law <a class="reference internal" href="#equation-elambda">(18)</a>–<a class="reference internal" href="#equation-dlambda">(19)</a>.</p>
<div class="math notranslate nohighlight" id="equation-d0">
<span class="eqno">(16)<a class="headerlink" href="#equation-d0" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}d_0 =
\begin{cases}
   0,             &amp; \text{if } \gamma \\
   E_P - e_A,     &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-b0">
<span class="eqno">(17)<a class="headerlink" href="#equation-b0" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}b_0 =
\begin{cases}
   0,             &amp; \text{if } \gamma \\
   1,             &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-elambda">
<span class="eqno">(18)<a class="headerlink" href="#equation-elambda" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}e_{\lambda} =
\begin{cases}
   b_{\lambda - 1} d_{\lambda - 1},
      &amp; \text{if } S_{\lambda} \geq d_{\lambda - 1} \\
   b_{\lambda - 1} S_{\lambda},
      &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-dlambda">
<span class="eqno">(19)<a class="headerlink" href="#equation-dlambda" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}d_{\lambda} =
\begin{cases}
   0,
      &amp; \text{if } S_{\lambda} \geq d_{\lambda - 1} \\
   \theta_{C} ( d_{\lambda - 1} - S_{\lambda} ),
      &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-blambda">
<span class="eqno">(20)<a class="headerlink" href="#equation-blambda" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\begin{split}b_{\lambda} =
\begin{cases}
   0,                &amp; \text{if } S_{\lambda} \geq d_{\lambda - 1} \\
   b_{\lambda - 1},  &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
</div>
<div class="section" id="under-water-limited-and-energy-limited-conditions">
<h4>Under water-limited and energy-limited conditions<a class="headerlink" href="#under-water-limited-and-energy-limited-conditions" title="Permalink to this headline"><span class="fa fa-link"></a></h4>
<p>At each time step, whether under water-limited or energy-limited conditions,
the soil layer states <span class="math notranslate nohighlight">\(S_{\lambda}\)</span> [mm] are updated given their inward
and outward fluxes during the time step as described in <a class="reference internal" href="#equation-dslambda">(21)</a>.</p>
<div class="math notranslate nohighlight" id="equation-dslambda">
<span class="eqno">(21)<a class="headerlink" href="#equation-dslambda" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\frac{dS_{\lambda}}{dt} =
   q_{\lambda - 1} - {s_{IF}}_{\lambda} - {s_{SGW}}_{\lambda}
   - {s_{DGW}}_{\lambda} - e_{\lambda}\]</div>
<p>The routing for the five runoff pathways is conceptualised as five linear
reservoirs which are characterised by three residence time parameters
<span class="math notranslate nohighlight">\(\theta_{SK}\)</span> [time step], <span class="math notranslate nohighlight">\(\theta_{FK}\)</span> [time step], and
<span class="math notranslate nohighlight">\(\theta_{GK}\)</span> [time step] <a class="reference internal" href="#equation-qof">(22)</a>–<a class="reference internal" href="#equation-qdgw">(26)</a>. The five runoff
pathways contribute to a final linear reservoir for channel routing which
is characterised by the residence time parameter <span class="math notranslate nohighlight">\(\theta_{RK}\)</span>
[time step] to compute the catchment total flow <span class="math notranslate nohighlight">\(Q\)</span> [mm/time step]
<a class="reference internal" href="#equation-q">(27)</a>.</p>
<div class="math notranslate nohighlight" id="equation-qof">
<span class="eqno">(22)<a class="headerlink" href="#equation-qof" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[q_{OF} = \frac{S_{OF}}{\theta_{SK}}\]</div>
<div class="math notranslate nohighlight" id="equation-qdf">
<span class="eqno">(23)<a class="headerlink" href="#equation-qdf" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[q_{DF} = \frac{S_{DF}}{\theta_{SK}}\]</div>
<div class="math notranslate nohighlight" id="equation-qif">
<span class="eqno">(24)<a class="headerlink" href="#equation-qif" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[q_{IF} = \frac{S_{IF}}{\theta_{FK}}\]</div>
<div class="math notranslate nohighlight" id="equation-qsgw">
<span class="eqno">(25)<a class="headerlink" href="#equation-qsgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[q_{SGW} = \frac{S_{SGW}}{\theta_{GK}}\]</div>
<div class="math notranslate nohighlight" id="equation-qdgw">
<span class="eqno">(26)<a class="headerlink" href="#equation-qdgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[q_{DGW} = \frac{S_{DGW}}{\theta_{GK}}\]</div>
<div class="math notranslate nohighlight" id="equation-q">
<span class="eqno">(27)<a class="headerlink" href="#equation-q" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[Q = \frac{S_R}{\theta_{RK}}\]</div>
<p>Finally, the reservoir states [mm] are updated given their inward and
outward fluxes during the time step as described in Equations
<a class="reference internal" href="#equation-dsof">(28)</a>–<a class="reference internal" href="#equation-dsrk">(33)</a>.</p>
<div class="math notranslate nohighlight" id="equation-dsof">
<span class="eqno">(28)<a class="headerlink" href="#equation-dsof" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\frac{dS_{OF}}{dt}  = \big( p_E - q_0 \big) - q_{OF}\]</div>
<div class="math notranslate nohighlight" id="equation-ssdf">
<span class="eqno">(29)<a class="headerlink" href="#equation-ssdf" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\frac{dS_{DF}}{dt} = r_{DF}  - q_{DF}\]</div>
<div class="math notranslate nohighlight" id="equation-dsif">
<span class="eqno">(30)<a class="headerlink" href="#equation-dsif" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\frac{dS_{IF}}{dt}  = \big( q_6 - r_{DF} \big) + r_{IF} - q_{IF}\]</div>
<div class="math notranslate nohighlight" id="equation-dssgw">
<span class="eqno">(31)<a class="headerlink" href="#equation-dssgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\frac{dS_{SGW}}{dt}  = r_{SGW} - q_{SGW}\]</div>
<div class="math notranslate nohighlight" id="equation-dsdgw">
<span class="eqno">(32)<a class="headerlink" href="#equation-dsdgw" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\frac{dS_{DGW}}{dt}  = r_{DGW} - q_{DGW}\]</div>
<div class="math notranslate nohighlight" id="equation-dsrk">
<span class="eqno">(33)<a class="headerlink" href="#equation-dsrk" title="Permalink to this equation"><span class="fa fa-link"></a></span>\[\frac{dS_{R}}{dt}  = q_{OF} + q_{DF} + q_{IF} + q_{SGW} + q_{DGW} - Q\]</div>
</div>
</div>
</div>
<div class="section" id="procedural-model">
<h2>Procedural model<a class="headerlink" href="#procedural-model" title="Permalink to this headline"><span class="fa fa-link"></a></h2>
<p>The python package <code class="xref py py-obj docutils literal notranslate"><span class="pre">smartpy</span></code> is a numerical implementation of the
equations described in the conceptual model presented above. This
procedural model numerically solves these equations using an explicit
forward Euler method, and an operator splitting technique (i.e. the
procedural model solves the equations sequentially following the order
presented above).</p>
</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <div class="footer-item">
      <p class="copyright">
            &copy; Copyright 2018-2022, Thibault Hallouin.
      </p>
    </div>
    <div class="footer-item">
      <p class="sphinx-version">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.
        Last updated on Jan 27, 2022.<br>
      </p>
    </div>
  </div>
</footer>
  </body>
</html>